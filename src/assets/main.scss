@use 'tailwindcss';

@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

@mixin color-variants($name, $base, $include-disabled: false) {
  --color-#{$name}: #{$base};
  --color-#{$name}-light: oklch(from #{$base} calc(l + 0.25) c h);
  --color-#{$name}-dark: oklch(from #{$base} calc(l - 0.15) c h);
  --color-#{$name}-solid-hover: oklch(from #{$base} calc(l - 0.08) c h);
  --color-#{$name}-ghost-hover: oklch(from #{$base} l c h / 0.1);
  --color-#{$name}-contrast: oklch(from #{$base} calc((0.6 - l) * 999) 0 h); // ðŸ‘ˆ

  @if $include-disabled {
    --color-disabled-bg: oklch(from #{$base} calc(l + 0.1) c h);
    --color-disabled-border: oklch(from #{$base} calc(l + 0.05) c h);
    --color-disabled-text: oklch(from #{$base} calc(l - 0.2) c h);
    --color-disabled-icon: oklch(from #{$base} calc(l + (1 - l) * 0.55) c h);
  }
}

@mixin typography($base, $mode: 'light') {
  --color-content-text: #{$base};
  --color-content-link: oklch(from #{$base} calc(l - 0.1) c h / 0.85);
  --color-content-code: oklch(from #{$base} l calc(c + 0.08) h);

  @if $mode == 'dark' {
    --color-content-text-secondary: oklch(from #{$base} calc(l + (1 - l) * 0.7) c h);
    --color-content-text-muted: oklch(from #{$base} calc(l + (1 - l) * 0.85) c h);
    --color-content-text-placeholder: oklch(from #{$base} calc(l + (1 - l) * 0.55) c h);
  } @else {
    --color-content-text-secondary: oklch(from #{$base} calc(l * 0.6) c h);
    --color-content-text-muted: oklch(from #{$base} calc(l * 0.4) c h);
    --color-content-text-placeholder: oklch(from #{$base} calc(l + (1 - l) * 0.55) c h);
  }
}

@mixin surface-colors($page-base, $surface-base, $mode: 'light', $border-base: null) {
  --color-page: #{$page-base};
  --color-page-contrast: oklch(from #{$page-base} calc((0.6 - l) * 999) 0 h);
  --color-surface: #{$surface-base};
  --color-surface-contrast: oklch(from #{$surface-base} calc((0.6 - l) * 999) 0 h);

  @if $mode == 'dark' {
    --color-page-alt: oklch(from #{$page-base} calc(l + 0.05) c h);
    --color-surface-alt: oklch(from #{$surface-base} calc(l + 0.1) c h);
  } @else {
    --color-page-alt: oklch(from #{$page-base} calc(l - 0.03) c h);
    --color-surface-alt: oklch(from #{$surface-base} calc(l - 0.06) c h);
  }

  @if $border-base {
    --color-surface-border: #{$border-base};
    --color-input-border: #{$border-base};
  }
}

@mixin panel-colors($base, $mode: 'light') {
  --color-panel-bg: #{$base};
  --color-panel-contrast: oklch(from #{$base} calc((0.6 - l) * 999) 0 h);
  --color-panel-bg-alt: oklch(from #{$base} calc(l - 0.04) c h);
  --color-panel-border: oklch(from #{$base} calc(l - 0.08) c h);
  --color-panel-stripe: oklch(from #{$base} calc(l + 0.03) c h);

  @if $mode == 'dark' {
    --color-panel-text: oklch(from #{$base} calc(l + (1 - l) * 0.75) c h);
    --color-panel-text-secondary: oklch(from #{$base} calc(l + (1 - l) * 0.5) c h);
  } @else {
    --color-panel-text: oklch(from #{$base} calc(l * 0.35) c h);
    --color-panel-text-secondary: oklch(from #{$base} calc(l * 0.55) c h);
  }
}

@theme {
  @include color-variants('brand', #0d6efd);
  @include color-variants('secondary', #a855f7);
  @include color-variants('success', #198754);
  @include color-variants('danger', #dc3545);
  @include color-variants('warning', #ffc107);
  @include color-variants('disabled', #6c757d, true);

  @include typography(#212529, 'light');
  @include surface-colors(#f8fafc, #ffffff, 'light', #e2e8f0);
  @include panel-colors(#e2e8f0, 'light');

  // --font-nes: 'Press Start 2P', sans-serif;
}

/* Dark Mode */
[data-mode='dark'] {
  @include typography(#e5e7eb, 'dark');
  @include surface-colors(#000000, #0d1117, 'dark', #27272a);
  @include panel-colors(#1e2530, 'dark');

  // @include typography(#ffb300, 'dark');
  // @include surface-colors(#1a1200, #1f1800, 'dark', #ffb300);
  // @include panel-colors(#2a1f00, 'dark');
  // @include color-variants('brand', #ffb300);
  // @include color-variants('disabled', #3a2e00, true);
}

[data-theme='blue'] {
  @include color-variants('brand', #0d6efd);
}

[data-theme='green'] {
  @include color-variants('brand', '#22c55e');
}

[data-theme='orange'] {
  @include color-variants('brand', '#f97316');
}

[data-theme='yellow'] {
  @include color-variants('brand', '#eab308');
}

[data-theme='fuchsia'] {
  @include color-variants('brand', #d946ef);
}

/* Other Themes */
[data-theme='retro-green'] {
  @include typography(#00ff41, 'dark');
  @include surface-colors(#0d0d0d, #0a1a0a, 'dark', #00ff41);
  @include panel-colors(#001a00, 'dark');
  @include color-variants('brand', #00ff41);
  @include color-variants('disabled', #1a3a1a, true);
}

[data-theme='retro-amber'] {
  @include typography(#ffb300, 'dark');
  @include surface-colors(#1a1200, #1f1800, 'dark', #ffb300);
  @include panel-colors(#2a1f00, 'dark');
  @include color-variants('brand', #ffb300);
  @include color-variants('disabled', #3a2e00, true);
}

[data-theme='plasma-red'] {
  @include typography(#e0e0e0, 'dark');
  @include surface-colors(#0a0a0f, #120a12, 'dark', #cc0000);
  @include panel-colors(#1a001a, 'dark');
  @include color-variants('brand', #cc0000);
  @include color-variants('disabled', #2a0a0a, true);
}

@layer components {
  .inline-highlight {
    @apply rounded-md text-content-code py-1 px-1 bg-surface-alt;
  }

  /* ---------------------------------- */
  /* Base                               */
  /* ---------------------------------- */
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-md cursor-pointer transition-colors px-4;
  }

  /* ---------------------------------- */
  /* Sizes                              */
  /* ---------------------------------- */
  .btn-sm {
    @apply h-6 text-sm;
  }

  .btn-md {
    @apply h-8 text-sm;
  }

  .btn-lg {
    @apply h-10 text-base;
  }

  .btn-xl {
    @apply h-12 text-base;
  }

  .btn-jumbo {
    @apply h-16 text-lg;
  }

  /* ---------------------------------- */
  /* Solid                              */
  /* ---------------------------------- */
  .btn-primary {
    @apply bg-brand text-brand-contrast hover:bg-brand-solid-hover;
  }

  .btn-secondary {
    @apply bg-secondary text-secondary-contrast hover:bg-secondary-solid-hover;
  }

  .btn-success {
    @apply bg-success text-success-contrast hover:bg-success-solid-hover;
  }

  .btn-danger {
    @apply bg-danger text-danger-contrast hover:bg-danger-solid-hover;
  }

  /* ---------------------------------- */
  /* Outlined                           */
  /* ---------------------------------- */
  .btn-outlined-primary {
    @apply bg-transparent border border-brand text-brand hover:bg-brand-ghost-hover;
  }

  .btn-outlined-secondary {
    @apply bg-transparent border border-secondary text-secondary hover:bg-secondary-ghost-hover;
  }

  .btn-outlined-success {
    @apply bg-transparent border border-success text-success hover:bg-success-ghost-hover;
  }

  .btn-outlined-danger {
    @apply bg-transparent border border-danger text-danger hover:bg-danger-ghost-hover;
  }

  /* ---------------------------------- */
  /* Text                               */
  /* ---------------------------------- */
  .btn-text-primary {
    @apply bg-transparent border-none text-brand hover:bg-brand-ghost-hover;
  }

  .btn-text-secondary {
    @apply bg-transparent border-none text-secondary hover:bg-secondary-ghost-hover;
  }

  .btn-text-success {
    @apply bg-transparent border-none text-success hover:bg-success-ghost-hover;
  }

  .btn-text-danger {
    @apply bg-transparent border-none text-danger hover:bg-danger-ghost-hover;
  }

  /* ---------------------------------- */
  /* Ghost                              */
  /* ---------------------------------- */
  .btn-ghost {
    @apply bg-surface border border-surface-border text-content-text hover:border-brand hover:text-brand;
  }

  /* ---------------------------------- */
  /* Link                               */
  /* ---------------------------------- */
  .btn-link {
    @apply bg-transparent border-none text-content-text hover:underline;
  }

  /* ---------------------------------- */
  /* Modifiers                          */
  /* ---------------------------------- */
  .btn-rounded {
    @apply rounded-full;
  }

  .btn-raised {
    @apply shadow-md/30;
  }

  .btn-icon {
    @apply aspect-square !p-0;
  }

  /* ---------------------------------- */
  /* States                             */
  /* ---------------------------------- */
  .btn-disabled {
    @apply bg-disabled-bg text-disabled-text border-disabled-border cursor-not-allowed pointer-events-none;
  }
}

@keyframes wave {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

.animate-wave::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
  animation: wave 1.5s infinite;
}

::view-transition-old(root),
::view-transition-new(root) {
  animation-duration: 600ms;
}
